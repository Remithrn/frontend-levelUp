import{r,b as m,u as S,az as y,j as e,c as h,B as $,D as k,E,F as z,i as g,a$ as D,b0 as F,I as L,aT as v,C as A,v as _,L as B}from"./index-BrrnQTzj.js";import{u as M}from"./index-DliO3oX5.js";const O=({setChanged:c})=>{const{isOpen:d,onOpen:i,onOpenChange:o}=M(),[n,s]=r.useState(""),[a,p]=r.useState(""),{access:x}=m(t=>t.auth),[N,f]=r.useState(!1),{friends_list:b}=m(t=>t.profile),[u,j]=r.useState([]),C=S();r.useEffect(()=>{C(y()),console.log("dj"),console.log(b,"friend_list")},[x]);const w=async()=>{console.log(n,a,u);const t=u.map(l=>l.user_id);console.log(t),f(!0);try{const l=await v.post("https://ec2-16-171-173-138.eu-north-1.compute.amazonaws.com/api/chat/group-chats/",{name:n,description:a,user_ids:t},{headers:{Authorization:`Bearer ${x}`}});console.log(l.data),c(G=>!G),f(!1),s(""),p(""),j([]),o()}catch(l){console.error("Error creating group:",l)}};return e.jsxs("div",{children:[e.jsx(h,{className:"hidden items-center gap-2 self-start rounded-2xl border-b-4 border-green-500 bg-green-400 px-5 py-6 font-bold uppercase text-white transition hover:brightness-110 md:flex",onClick:i,children:"Create Group"}),e.jsx($,{isOpen:d,onOpenChange:o,children:e.jsxs(k,{children:[e.jsx(E,{children:e.jsx("h1",{className:"text-2xl font-bold",children:"Create Group"})}),e.jsxs(z,{children:[e.jsx(g,{label:"Group Name",value:n,onChange:t=>s(t.target.value)}),e.jsx(g,{label:"Description",value:a,onChange:t=>p(t.target.value)}),e.jsx(D,{label:"Group Members",placeholder:"Select friends",selectionMode:"multiple",className:"max-w-xs",children:b.map(t=>e.jsx(F,{onClick:()=>j([...u,t]),children:t.username},t.id))})]}),e.jsxs(L,{children:[e.jsx(h,{onClick:o,children:"Cancel"}),e.jsx(h,{onClick:w,isLoading:N,children:"Create"})]})]})})]})},T=()=>{const[c,d]=r.useState([]),{access:i}=m(s=>s.auth),[o,n]=r.useState(!1);return r.useEffect(()=>{v.get("https://ec2-16-171-173-138.eu-north-1.compute.amazonaws.com/api/chat/group-chats/",{headers:{Authorization:`Bearer ${i}`}}).then(s=>{d(s.data)})},[i,o]),e.jsx(A,{children:e.jsxs("div",{className:"p-8",children:[e.jsx("h1",{className:"text-3xl font-bold mb-6 border-b pb-4  uppercase",children:"Group Chat"}),e.jsx(_,{}),e.jsx("div",{className:"space-y-6",children:c.length>0?c.map(s=>e.jsxs("div",{className:"flex flex-col items-start gap-2 self-start rounded-2xl border-b-4 border-violet-500 bg-violet-400 px-5 py-6 font-bold uppercase text-white transition hover:brightness-110 md:flex",children:[e.jsx(B,{to:`/group-chat/${s.id}`,className:"text-2xl font-bold text-white block transition-colors hover:text-gray-200",children:s.name}),e.jsx(_,{className:"bg-white"}),s.admins.length>0&&e.jsxs("p",{className:"text-white",children:["Admin: ",s.admins.map(a=>a.user.username).join(", ")]}),e.jsxs("p",{className:"text-white",children:["Members: ",s.users.length>3?`${s.users.slice(0,3).map(a=>a.username).join(", ")}, and ${s.users.length-3} more`:s.users.map(a=>a.username).join(", ")]})]},s.id)):e.jsx("p",{className:"text-gray-500 text-center text-lg",children:"No group chats available."})}),e.jsx("div",{className:"mt-8",children:e.jsx(O,{setChanged:n})})]})})};export{T as default};
